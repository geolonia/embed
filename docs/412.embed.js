(self.webpackChunk_geolonia_embed=self.webpackChunk_geolonia_embed||[]).push([[412],{8714:function(e,t,o){"use strict";o.r(t);var i=o(6158),l=o.n(i),s=o(9319),n=o.n(s),r=o(1423),a=o(1036),c=o.n(a);function u(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}const p="#000000",g="#FFFFFF",y="rgba(255, 0, 0, 0.4)",m="#FFFFFF";let d=function(){function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.json=t,this.options={cluster:!0,heatmap:!1,clusterColor:"#ff0000",...o}}var t,o;return t=e,(o=[{key:"addTo",value:function(e){const t=this.json.features,o=t.filter((e=>"point"!==e.geometry.type.toLowerCase())),i=t.filter((e=>"point"===e.geometry.type.toLowerCase()));e.addSource("geolonia-simple-style",{type:"geojson",data:{type:"FeatureCollection",features:o}}),this.setPolygonGeometries(e),this.setLineGeometries(e),e.addSource("geolonia-simple-style-points",{type:"geojson",data:{type:"FeatureCollection",features:i},cluster:this.options.cluster,clusterMaxZoom:14,clusterRadius:50}),e.addLayer({id:"geolonia-simple-style-polygon-symbol",type:"symbol",source:"geolonia-simple-style",filter:["==","$type","Polygon"],paint:{"text-color":["string",["get","text-color"],p],"text-halo-color":["string",["get","text-halo-color"],g],"text-halo-width":1},layout:{"text-field":["get","title"],"text-font":["Noto Sans Regular"],"text-size":12,"text-max-width":12,"text-allow-overlap":!1}}),e.addLayer({id:"geolonia-simple-style-linestring-symbol",type:"symbol",source:"geolonia-simple-style",filter:["==","$type","LineString"],paint:{"text-color":["string",["get","text-color"],p],"text-halo-color":["string",["get","text-halo-color"],g],"text-halo-width":1},layout:{"symbol-placement":"line","text-field":["get","title"],"text-font":["Noto Sans Regular"],"text-size":12,"text-max-width":12,"text-allow-overlap":!1}}),this.setPointGeometries(e),this.setCluster(e);const l=e.getContainer();if(!l.dataset||!l.dataset.lng&&!l.dataset.lat){const t=n()(this.json);e.fitBounds(t,{duration:0,padding:30})}}},{key:"setPolygonGeometries",value:function(e){e.addLayer({id:"geolonia-simple-style-polygon",type:"fill",source:"geolonia-simple-style",filter:["==","$type","Polygon"],paint:{"fill-color":["string",["get","fill"],y],"fill-opacity":["number",["get","fill-opacity"],1],"fill-outline-color":["string",["get","stroke"],m]}}),this.setPopup(e,"geolonia-simple-style-polygon")}},{key:"setLineGeometries",value:function(e){e.addLayer({id:"geolonia-simple-style-linestring",type:"line",source:"geolonia-simple-style",filter:["==","$type","LineString"],paint:{"line-width":["number",["get","stroke-width"],2],"line-color":["string",["get","stroke"],y],"line-opacity":["number",["get","stroke-opacity"],1]},layout:{"line-cap":"round","line-join":"round"}}),this.setPopup(e,"geolonia-simple-style-linestring")}},{key:"setPointGeometries",value:function(e){e.addLayer({id:"circle-simple-style-points",type:"circle",source:"geolonia-simple-style-points",filter:["!",["has","point_count"]],paint:{"circle-radius":["case",["==","small",["get","marker-size"]],7,["==","large",["get","marker-size"]],13,9],"circle-color":["string",["get","marker-color"],y],"circle-opacity":["number",["get","fill-opacity"],1],"circle-stroke-width":["number",["get","stroke-width"],1],"circle-stroke-color":["string",["get","stroke"],m],"circle-stroke-opacity":["number",["get","stroke-opacity"],1]}}),e.addLayer({id:"symbol-simple-style-points",type:"symbol",source:"geolonia-simple-style-points",filter:["!",["has","point_count"]],paint:{"text-color":["string",["get","text-color"],p],"text-halo-color":["string",["get","text-halo-color"],g],"text-halo-width":1},layout:{"icon-image":["case",["==","large",["get","marker-size"]],["image",["concat",["get","marker-symbol"],"-15"]],["image",["concat",["get","marker-symbol"],"-11"]]],"text-field":["get","title"],"text-font":["Noto Sans Regular"],"text-size":12,"text-anchor":"top","text-max-width":12,"text-offset":["case",["==","small",["get","marker-size"]],["literal",[0,.6]],["==","large",["get","marker-size"]],["literal",[0,1.2]],["literal",[0,.8]]],"text-allow-overlap":!1}}),this.setPopup(e,"circle-simple-style-points")}},{key:"setPopup",value:function(e,t){e.on("click",t,(t=>{const o=(0,r.Z)(t.features[0]).geometry.coordinates,i=t.features[0].properties.description;i&&(new(l().Popup)).setLngLat(o).setHTML(c()(i)).addTo(e)})),e.on("mouseenter",t,(t=>{t.features[0].properties.description&&(e.getCanvas().style.cursor="pointer")})),e.on("mouseleave",t,(()=>{e.getCanvas().style.cursor=""}))}},{key:"setCluster",value:function(e){e.addLayer({id:"clusters",type:"circle",source:"geolonia-simple-style-points",filter:["has","point_count"],paint:{"circle-radius":20,"circle-color":this.options.clusterColor,"circle-opacity":1}}),e.addLayer({id:"cluster-count",type:"symbol",source:"geolonia-simple-style-points",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-size":14,"text-font":["Noto Sans Regular"]}}),e.on("click","clusters",(function(t){const o=e.queryRenderedFeatures(t.point,{layers:["clusters"]}),i=o[0].properties.cluster_id;e.getSource("geolonia-simple-style-points").getClusterExpansionZoom(i,(function(t,i){t||e.easeTo({center:o[0].geometry.coordinates,zoom:i})}))})),e.on("mouseenter","clusters",(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave","clusters",(function(){e.getCanvas().style.cursor=""}))}}])&&u(t.prototype,o),e}();t.default=d},2868:function(){},5574:function(){},4777:function(){},9830:function(){},209:function(){},7414:function(){}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AZ2VvbG9uaWEvZW1iZWQvLi9zcmMvbGliL3NpbXBsZXN0eWxlLmpzIl0sIm5hbWVzIjpbInRleHRDb2xvciIsInRleHRIYWxvQ29sb3IiLCJiYWNrZ3JvdW5kQ29sb3IiLCJzdHJva2VDb2xvciIsInNpbXBsZVN0eWxlIiwianNvbiIsIm9wdGlvbnMiLCJ0aGlzIiwiY2x1c3RlciIsImhlYXRtYXAiLCJjbHVzdGVyQ29sb3IiLCJtYXAiLCJmZWF0dXJlcyIsInBvbHlnb25hbmRsaW5lcyIsImZpbHRlciIsImZlYXR1cmUiLCJnZW9tZXRyeSIsInR5cGUiLCJ0b0xvd2VyQ2FzZSIsInBvaW50cyIsImFkZFNvdXJjZSIsImRhdGEiLCJzZXRQb2x5Z29uR2VvbWV0cmllcyIsInNldExpbmVHZW9tZXRyaWVzIiwiY2x1c3Rlck1heFpvb20iLCJjbHVzdGVyUmFkaXVzIiwiYWRkTGF5ZXIiLCJpZCIsInNvdXJjZSIsInBhaW50IiwibGF5b3V0Iiwic2V0UG9pbnRHZW9tZXRyaWVzIiwic2V0Q2x1c3RlciIsImNvbnRhaW5lciIsImdldENvbnRhaW5lciIsImRhdGFzZXQiLCJsbmciLCJsYXQiLCJib3VuZHMiLCJnZW9qc29uRXh0ZW50IiwiZml0Qm91bmRzIiwiZHVyYXRpb24iLCJwYWRkaW5nIiwic2V0UG9wdXAiLCJvbiIsImUiLCJjZW50ZXIiLCJ0dXJmQ2VudGVyIiwiY29vcmRpbmF0ZXMiLCJkZXNjcmlwdGlvbiIsInByb3BlcnRpZXMiLCJtYXBib3hnbCIsInNldExuZ0xhdCIsInNldEhUTUwiLCJzYW5pdGl6ZUh0bWwiLCJhZGRUbyIsImdldENhbnZhcyIsInN0eWxlIiwiY3Vyc29yIiwicXVlcnlSZW5kZXJlZEZlYXR1cmVzIiwicG9pbnQiLCJsYXllcnMiLCJjbHVzdGVySWQiLCJjbHVzdGVyX2lkIiwiZ2V0U291cmNlIiwiZ2V0Q2x1c3RlckV4cGFuc2lvblpvb20iLCJlcnIiLCJ6b29tIiwiZWFzZVRvIl0sIm1hcHBpbmdzIjoi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QUFZbEQsRUFBUyxHQUFHc0MsV0FBV2EsV0FDekNwRCxFQUFJcUQsVUFBVSxnQ0FBZ0NDLHdCQUF3QkgsR0FBVyxTQUFVSSxFQUFLQyxHQUMxRkQsR0FHSnZELEVBQUl5RCxPQUFPLENBQ1R0QixPQUFRbEMsRUFBUyxHQUFHSSxTQUFTZ0MsWUFDN0JtQixLQUFNQSxVQUtaeEQsRUFBSWlDLEdBQUcsYUFBYyxZQUFZLFdBQy9CakMsRUFBSTZDLFlBQVlDLE1BQU1DLE9BQVMsYUFHakMvQyxFQUFJaUMsR0FBRyxhQUFjLFlBQVksV0FDL0JqQyxFQUFJNkMsWUFBWUMsTUFBTUMsT0FBUyxXLHNCQUtyQyxhIiwiZmlsZSI6IjQxMi5lbWJlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5pbXBvcnQgbWFwYm94Z2wgZnJvbSAnbWFwYm94LWdsJ1xuaW1wb3J0IGdlb2pzb25FeHRlbnQgZnJvbSAnQG1hcGJveC9nZW9qc29uLWV4dGVudCdcbmltcG9ydCB0dXJmQ2VudGVyIGZyb20gJ0B0dXJmL2NlbnRlcidcbmltcG9ydCBzYW5pdGl6ZUh0bWwgZnJvbSAnc2FuaXRpemUtaHRtbCdcblxuY29uc3QgdGV4dENvbG9yID0gJyMwMDAwMDAnXG5jb25zdCB0ZXh0SGFsb0NvbG9yID0gJyNGRkZGRkYnXG5jb25zdCBiYWNrZ3JvdW5kQ29sb3IgPSAncmdiYSgyNTUsIDAsIDAsIDAuNCknXG5jb25zdCBzdHJva2VDb2xvciA9ICcjRkZGRkZGJ1xuXG5jbGFzcyBzaW1wbGVTdHlsZSB7XG4gIGNvbnN0cnVjdG9yKGpzb24sIG9wdGlvbnMpIHtcbiAgICB0aGlzLmpzb24gPSBqc29uXG5cbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBjbHVzdGVyOiB0cnVlLFxuICAgICAgaGVhdG1hcDogZmFsc2UsXG4gICAgICBjbHVzdGVyQ29sb3I6ICcjZmYwMDAwJyxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgfVxuICB9XG5cbiAgYWRkVG8obWFwKSB7XG4gICAgY29uc3QgZmVhdHVyZXMgPSB0aGlzLmpzb24uZmVhdHVyZXNcbiAgICBjb25zdCBwb2x5Z29uYW5kbGluZXMgPSBmZWF0dXJlcy5maWx0ZXIoZmVhdHVyZSA9PiAoJ3BvaW50JyAhPT0gZmVhdHVyZS5nZW9tZXRyeS50eXBlLnRvTG93ZXJDYXNlKCkpKVxuICAgIGNvbnN0IHBvaW50cyA9IGZlYXR1cmVzLmZpbHRlcihmZWF0dXJlID0+ICgncG9pbnQnID09PSBmZWF0dXJlLmdlb21ldHJ5LnR5cGUudG9Mb3dlckNhc2UoKSkpXG5cbiAgICBtYXAuYWRkU291cmNlKCdnZW9sb25pYS1zaW1wbGUtc3R5bGUnLCB7XG4gICAgICB0eXBlOiAnZ2VvanNvbicsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXG4gICAgICAgIGZlYXR1cmVzOiBwb2x5Z29uYW5kbGluZXMsXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB0aGlzLnNldFBvbHlnb25HZW9tZXRyaWVzKG1hcClcbiAgICB0aGlzLnNldExpbmVHZW9tZXRyaWVzKG1hcClcblxuICAgIG1hcC5hZGRTb3VyY2UoJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1wb2ludHMnLCB7XG4gICAgICB0eXBlOiAnZ2VvanNvbicsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsXG4gICAgICAgIGZlYXR1cmVzOiBwb2ludHMsXG4gICAgICB9LFxuICAgICAgY2x1c3RlcjogdGhpcy5vcHRpb25zLmNsdXN0ZXIsXG4gICAgICBjbHVzdGVyTWF4Wm9vbTogMTQsXG4gICAgICBjbHVzdGVyUmFkaXVzOiA1MCxcbiAgICB9KVxuXG4gICAgbWFwLmFkZExheWVyKHtcbiAgICAgIGlkOiAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlLXBvbHlnb24tc3ltYm9sJyxcbiAgICAgIHR5cGU6ICdzeW1ib2wnLFxuICAgICAgc291cmNlOiAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlJyxcbiAgICAgIGZpbHRlcjogWyc9PScsICckdHlwZScsICdQb2x5Z29uJ10sXG4gICAgICBwYWludDoge1xuICAgICAgICAndGV4dC1jb2xvcic6IFsnc3RyaW5nJywgWydnZXQnLCAndGV4dC1jb2xvciddLCB0ZXh0Q29sb3JdLFxuICAgICAgICAndGV4dC1oYWxvLWNvbG9yJzogWydzdHJpbmcnLCBbJ2dldCcsICd0ZXh0LWhhbG8tY29sb3InXSwgdGV4dEhhbG9Db2xvcl0sXG4gICAgICAgICd0ZXh0LWhhbG8td2lkdGgnOiAxLFxuICAgICAgfSxcbiAgICAgIGxheW91dDoge1xuICAgICAgICAndGV4dC1maWVsZCc6IFsnZ2V0JywgJ3RpdGxlJ10sXG4gICAgICAgICd0ZXh0LWZvbnQnOiBbJ05vdG8gU2FucyBSZWd1bGFyJ10sXG4gICAgICAgICd0ZXh0LXNpemUnOiAxMixcbiAgICAgICAgJ3RleHQtbWF4LXdpZHRoJzogMTIsXG4gICAgICAgICd0ZXh0LWFsbG93LW92ZXJsYXAnOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIG1hcC5hZGRMYXllcih7XG4gICAgICBpZDogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1saW5lc3RyaW5nLXN5bWJvbCcsXG4gICAgICB0eXBlOiAnc3ltYm9sJyxcbiAgICAgIHNvdXJjZTogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZScsXG4gICAgICBmaWx0ZXI6IFsnPT0nLCAnJHR5cGUnLCAnTGluZVN0cmluZyddLFxuICAgICAgcGFpbnQ6IHtcbiAgICAgICAgJ3RleHQtY29sb3InOiBbJ3N0cmluZycsIFsnZ2V0JywgJ3RleHQtY29sb3InXSwgdGV4dENvbG9yXSxcbiAgICAgICAgJ3RleHQtaGFsby1jb2xvcic6IFsnc3RyaW5nJywgWydnZXQnLCAndGV4dC1oYWxvLWNvbG9yJ10sIHRleHRIYWxvQ29sb3JdLFxuICAgICAgICAndGV4dC1oYWxvLXdpZHRoJzogMSxcbiAgICAgIH0sXG4gICAgICBsYXlvdXQ6IHtcbiAgICAgICAgJ3N5bWJvbC1wbGFjZW1lbnQnOiAnbGluZScsXG4gICAgICAgICd0ZXh0LWZpZWxkJzogWydnZXQnLCAndGl0bGUnXSxcbiAgICAgICAgJ3RleHQtZm9udCc6IFsnTm90byBTYW5zIFJlZ3VsYXInXSxcbiAgICAgICAgJ3RleHQtc2l6ZSc6IDEyLFxuICAgICAgICAndGV4dC1tYXgtd2lkdGgnOiAxMixcbiAgICAgICAgJ3RleHQtYWxsb3ctb3ZlcmxhcCc6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgdGhpcy5zZXRQb2ludEdlb21ldHJpZXMobWFwKVxuICAgIHRoaXMuc2V0Q2x1c3RlcihtYXApXG5cbiAgICBjb25zdCBjb250YWluZXIgPSBtYXAuZ2V0Q29udGFpbmVyKClcblxuICAgIGlmICghY29udGFpbmVyLmRhdGFzZXQgfHwgKCFjb250YWluZXIuZGF0YXNldC5sbmcgJiYgIWNvbnRhaW5lci5kYXRhc2V0LmxhdCkpIHtcbiAgICAgIGNvbnN0IGJvdW5kcyA9IGdlb2pzb25FeHRlbnQodGhpcy5qc29uKVxuICAgICAgbWFwLmZpdEJvdW5kcyhib3VuZHMsIHtcbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIHBhZGRpbmc6IDMwLFxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2V0IHBvbHlnb24gZ2VvbWV0cmllcy5cbiAgICpcbiAgICogQHBhcmFtIG1hcFxuICAgKi9cbiAgc2V0UG9seWdvbkdlb21ldHJpZXMobWFwKSB7XG4gICAgbWFwLmFkZExheWVyKHtcbiAgICAgIGlkOiAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlLXBvbHlnb24nLFxuICAgICAgdHlwZTogJ2ZpbGwnLFxuICAgICAgc291cmNlOiAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlJyxcbiAgICAgIGZpbHRlcjogWyc9PScsICckdHlwZScsICdQb2x5Z29uJ10sXG4gICAgICBwYWludDoge1xuICAgICAgICAnZmlsbC1jb2xvcic6IFsnc3RyaW5nJywgWydnZXQnLCAnZmlsbCddLCBiYWNrZ3JvdW5kQ29sb3JdLFxuICAgICAgICAnZmlsbC1vcGFjaXR5JzogWydudW1iZXInLCBbJ2dldCcsICdmaWxsLW9wYWNpdHknXSwgMS4wXSxcbiAgICAgICAgJ2ZpbGwtb3V0bGluZS1jb2xvcic6IFsnc3RyaW5nJywgWydnZXQnLCAnc3Ryb2tlJ10sIHN0cm9rZUNvbG9yXSxcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIHRoaXMuc2V0UG9wdXAobWFwLCAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlLXBvbHlnb24nKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldCBsaW5lIGdlb21ldHJpZXMuXG4gICAqXG4gICAqIEBwYXJhbSBtYXBcbiAgICovXG4gIHNldExpbmVHZW9tZXRyaWVzKG1hcCkge1xuICAgIG1hcC5hZGRMYXllcih7XG4gICAgICBpZDogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1saW5lc3RyaW5nJyxcbiAgICAgIHR5cGU6ICdsaW5lJyxcbiAgICAgIHNvdXJjZTogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZScsXG4gICAgICBmaWx0ZXI6IFsnPT0nLCAnJHR5cGUnLCAnTGluZVN0cmluZyddLFxuICAgICAgcGFpbnQ6IHtcbiAgICAgICAgJ2xpbmUtd2lkdGgnOiBbJ251bWJlcicsIFsnZ2V0JywgJ3N0cm9rZS13aWR0aCddLCAyXSxcbiAgICAgICAgJ2xpbmUtY29sb3InOiBbJ3N0cmluZycsIFsnZ2V0JywgJ3N0cm9rZSddLCBiYWNrZ3JvdW5kQ29sb3JdLFxuICAgICAgICAnbGluZS1vcGFjaXR5JzogWydudW1iZXInLCBbJ2dldCcsICdzdHJva2Utb3BhY2l0eSddLCAxLjBdLFxuICAgICAgfSxcbiAgICAgIGxheW91dDoge1xuICAgICAgICAnbGluZS1jYXAnOiAncm91bmQnLFxuICAgICAgICAnbGluZS1qb2luJzogJ3JvdW5kJyxcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIHRoaXMuc2V0UG9wdXAobWFwLCAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlLWxpbmVzdHJpbmcnKVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIHBvaW50IGdlb21ldHJpZXMuXG4gICAqXG4gICAqIEBwYXJhbSBtYXBcbiAgICovXG4gIHNldFBvaW50R2VvbWV0cmllcyhtYXApIHtcbiAgICBtYXAuYWRkTGF5ZXIoe1xuICAgICAgaWQ6ICdjaXJjbGUtc2ltcGxlLXN0eWxlLXBvaW50cycsXG4gICAgICB0eXBlOiAnY2lyY2xlJyxcbiAgICAgIHNvdXJjZTogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1wb2ludHMnLFxuICAgICAgZmlsdGVyOiBbJyEnLCBbJ2hhcycsICdwb2ludF9jb3VudCddXSxcbiAgICAgIHBhaW50OiB7XG4gICAgICAgICdjaXJjbGUtcmFkaXVzJzogW1xuICAgICAgICAgICdjYXNlJyxcbiAgICAgICAgICBbJz09JywgJ3NtYWxsJywgWydnZXQnLCAnbWFya2VyLXNpemUnXV0sIDcsXG4gICAgICAgICAgWyc9PScsICdsYXJnZScsIFsnZ2V0JywgJ21hcmtlci1zaXplJ11dLCAxMyxcbiAgICAgICAgICA5LFxuICAgICAgICBdLFxuICAgICAgICAnY2lyY2xlLWNvbG9yJzogWydzdHJpbmcnLCBbJ2dldCcsICdtYXJrZXItY29sb3InXSwgYmFja2dyb3VuZENvbG9yXSxcbiAgICAgICAgJ2NpcmNsZS1vcGFjaXR5JzogWydudW1iZXInLCBbJ2dldCcsICdmaWxsLW9wYWNpdHknXSwgMS4wXSxcbiAgICAgICAgJ2NpcmNsZS1zdHJva2Utd2lkdGgnOiBbJ251bWJlcicsIFsnZ2V0JywgJ3N0cm9rZS13aWR0aCddLCAxXSxcbiAgICAgICAgJ2NpcmNsZS1zdHJva2UtY29sb3InOiBbJ3N0cmluZycsIFsnZ2V0JywgJ3N0cm9rZSddLCBzdHJva2VDb2xvcl0sXG4gICAgICAgICdjaXJjbGUtc3Ryb2tlLW9wYWNpdHknOiBbJ251bWJlcicsIFsnZ2V0JywgJ3N0cm9rZS1vcGFjaXR5J10sIDEuMF0sXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICBtYXAuYWRkTGF5ZXIoe1xuICAgICAgaWQ6ICdzeW1ib2wtc2ltcGxlLXN0eWxlLXBvaW50cycsXG4gICAgICB0eXBlOiAnc3ltYm9sJyxcbiAgICAgIHNvdXJjZTogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1wb2ludHMnLFxuICAgICAgZmlsdGVyOiBbJyEnLCBbJ2hhcycsICdwb2ludF9jb3VudCddXSxcbiAgICAgIHBhaW50OiB7XG4gICAgICAgICd0ZXh0LWNvbG9yJzogWydzdHJpbmcnLCBbJ2dldCcsICd0ZXh0LWNvbG9yJ10sIHRleHRDb2xvcl0sXG4gICAgICAgICd0ZXh0LWhhbG8tY29sb3InOiBbJ3N0cmluZycsIFsnZ2V0JywgJ3RleHQtaGFsby1jb2xvciddLCB0ZXh0SGFsb0NvbG9yXSxcbiAgICAgICAgJ3RleHQtaGFsby13aWR0aCc6IDEsXG4gICAgICB9LFxuICAgICAgbGF5b3V0OiB7XG4gICAgICAgICdpY29uLWltYWdlJzogW1xuICAgICAgICAgICdjYXNlJyxcbiAgICAgICAgICBbJz09JywgJ2xhcmdlJywgWydnZXQnLCAnbWFya2VyLXNpemUnXV0sIFsnaW1hZ2UnLCBbJ2NvbmNhdCcsIFsnZ2V0JywgJ21hcmtlci1zeW1ib2wnXSwgJy0xNSddXSxcbiAgICAgICAgICBbJ2ltYWdlJywgWydjb25jYXQnLCBbJ2dldCcsICdtYXJrZXItc3ltYm9sJ10sICctMTEnXV0sXG4gICAgICAgIF0sXG4gICAgICAgICd0ZXh0LWZpZWxkJzogWydnZXQnLCAndGl0bGUnXSxcbiAgICAgICAgJ3RleHQtZm9udCc6IFsnTm90byBTYW5zIFJlZ3VsYXInXSxcbiAgICAgICAgJ3RleHQtc2l6ZSc6IDEyLFxuICAgICAgICAndGV4dC1hbmNob3InOiAndG9wJyxcbiAgICAgICAgJ3RleHQtbWF4LXdpZHRoJzogMTIsXG4gICAgICAgICd0ZXh0LW9mZnNldCc6IFtcbiAgICAgICAgICAnY2FzZScsXG4gICAgICAgICAgWyc9PScsICdzbWFsbCcsIFsnZ2V0JywgJ21hcmtlci1zaXplJ11dLCBbJ2xpdGVyYWwnLCBbMCwgMC42XV0sXG4gICAgICAgICAgWyc9PScsICdsYXJnZScsIFsnZ2V0JywgJ21hcmtlci1zaXplJ11dLCBbJ2xpdGVyYWwnLCBbMCwgMS4yXV0sXG4gICAgICAgICAgWydsaXRlcmFsJywgWzAsIDAuOF1dLFxuICAgICAgICBdLFxuICAgICAgICAndGV4dC1hbGxvdy1vdmVybGFwJzogZmFsc2UsXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB0aGlzLnNldFBvcHVwKG1hcCwgJ2NpcmNsZS1zaW1wbGUtc3R5bGUtcG9pbnRzJylcbiAgfVxuXG4gIHNldFBvcHVwKG1hcCwgc291cmNlKSB7XG4gICAgbWFwLm9uKCdjbGljaycsIHNvdXJjZSwgZSA9PiB7XG4gICAgICBjb25zdCBjZW50ZXIgPSB0dXJmQ2VudGVyKGUuZmVhdHVyZXNbMF0pLmdlb21ldHJ5LmNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGUuZmVhdHVyZXNbMF0ucHJvcGVydGllcy5kZXNjcmlwdGlvblxuXG4gICAgICBpZiAoZGVzY3JpcHRpb24pIHtcbiAgICAgICAgbmV3IG1hcGJveGdsLlBvcHVwKCkuc2V0TG5nTGF0KGNlbnRlcikuc2V0SFRNTChzYW5pdGl6ZUh0bWwoZGVzY3JpcHRpb24pKS5hZGRUbyhtYXApXG4gICAgICB9XG4gICAgfSlcblxuICAgIG1hcC5vbignbW91c2VlbnRlcicsIHNvdXJjZSwgZSA9PiB7XG4gICAgICBpZiAoZS5mZWF0dXJlc1swXS5wcm9wZXJ0aWVzLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgIG1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcidcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgbWFwLm9uKCdtb3VzZWxlYXZlJywgc291cmNlLCAoKSA9PiB7XG4gICAgICBtYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gJydcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIGNsdXN0ZXIgbWFya2Vyc1xuICAgKlxuICAgKiBAcGFyYW0gbWFwXG4gICAqL1xuICBzZXRDbHVzdGVyKG1hcCkge1xuICAgIG1hcC5hZGRMYXllcih7XG4gICAgICBpZDogJ2NsdXN0ZXJzJyxcbiAgICAgIHR5cGU6ICdjaXJjbGUnLFxuICAgICAgc291cmNlOiAnZ2VvbG9uaWEtc2ltcGxlLXN0eWxlLXBvaW50cycsXG4gICAgICBmaWx0ZXI6IFsnaGFzJywgJ3BvaW50X2NvdW50J10sXG4gICAgICBwYWludDoge1xuICAgICAgICAnY2lyY2xlLXJhZGl1cyc6IDIwLFxuICAgICAgICAnY2lyY2xlLWNvbG9yJzogdGhpcy5vcHRpb25zLmNsdXN0ZXJDb2xvcixcbiAgICAgICAgJ2NpcmNsZS1vcGFjaXR5JzogMS4wLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgbWFwLmFkZExheWVyKHtcbiAgICAgIGlkOiAnY2x1c3Rlci1jb3VudCcsXG4gICAgICB0eXBlOiAnc3ltYm9sJyxcbiAgICAgIHNvdXJjZTogJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1wb2ludHMnLFxuICAgICAgZmlsdGVyOiBbJ2hhcycsICdwb2ludF9jb3VudCddLFxuICAgICAgbGF5b3V0OiB7XG4gICAgICAgICd0ZXh0LWZpZWxkJzogJ3twb2ludF9jb3VudF9hYmJyZXZpYXRlZH0nLFxuICAgICAgICAndGV4dC1zaXplJzogMTQsXG4gICAgICAgICd0ZXh0LWZvbnQnOiBbJ05vdG8gU2FucyBSZWd1bGFyJ10sXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICBtYXAub24oJ2NsaWNrJywgJ2NsdXN0ZXJzJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvbnN0IGZlYXR1cmVzID0gbWFwLnF1ZXJ5UmVuZGVyZWRGZWF0dXJlcyhlLnBvaW50LCB7IGxheWVyczogWydjbHVzdGVycyddIH0pXG4gICAgICBjb25zdCBjbHVzdGVySWQgPSBmZWF0dXJlc1swXS5wcm9wZXJ0aWVzLmNsdXN0ZXJfaWRcbiAgICAgIG1hcC5nZXRTb3VyY2UoJ2dlb2xvbmlhLXNpbXBsZS1zdHlsZS1wb2ludHMnKS5nZXRDbHVzdGVyRXhwYW5zaW9uWm9vbShjbHVzdGVySWQsIGZ1bmN0aW9uIChlcnIsIHpvb20pIHtcbiAgICAgICAgaWYgKGVycilcbiAgICAgICAgICByZXR1cm5cblxuICAgICAgICBtYXAuZWFzZVRvKHtcbiAgICAgICAgICBjZW50ZXI6IGZlYXR1cmVzWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzLFxuICAgICAgICAgIHpvb206IHpvb20sXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICBtYXAub24oJ21vdXNlZW50ZXInLCAnY2x1c3RlcnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBtYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInXG4gICAgfSlcblxuICAgIG1hcC5vbignbW91c2VsZWF2ZScsICdjbHVzdGVycycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIG1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAnJ1xuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgc2ltcGxlU3R5bGVcbiJdLCJzb3VyY2VSb290IjoiIn0=